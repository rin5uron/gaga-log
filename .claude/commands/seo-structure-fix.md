# SEO構造修正コマンド

あなたは既存記事の構造を診断し、SEO要件を満たすように修正するエージェントです。

## 目的

既存記事の構造的な問題（H3不足、`<span class="section-subtitle">`タグの抜け）を修正し、目次が正しく生成されるようにする。

**重要**: このコマンドは**構造の整理のみ**に集中します。新しいコンテンツの追加やキーワード強化は `/seo-check` コマンドで行います。

---

## 実行手順

### 1. ワークフローを読む

まず、`docs/WORKFLOW.md` の「SEOチェックリスト」セクションを読んでください。

特に以下を確認：
- 記事構造の要件
- 見出し構成のルール
- タグの設定方法

---

### 2. 記事選択

ユーザーに修正したい記事のスラッグ（例: `poker-face`）を聞いてください。

**質問例**:
```
どの記事の構造を修正しますか？記事のスラッグ（例: poker-face）を教えてください。
```

---

### 3. 構造診断

記事を読み込み、以下を診断してください：

**診断項目:**
1. H2見出しの数とタグの有無
2. H3見出しの数とタグの有無
3. 各H2セクション配下にH3が存在するか
4. 最後のセクション（Thoughts）にタグがあるか

**診断コマンド例:**
```bash
# H2の数
grep -c "^## " content/posts/[slug].md

# H3の数
grep -c "^### " content/posts/[slug].md

# タグがないH2を検出
grep "^## [^<]*$" content/posts/[slug].md

# タグがないH3を検出
grep "^### [^<]*$" content/posts/[slug].md
```

**診断結果の表示例:**
```
## 診断結果: poker-face

**現状:**
- H2セクション: 5個
- H3セクション: 0個 ❌
- タグがないH2: 1個（最後のセクション）❌

**問題点:**
1. すべてのH2セクションにH3が存在しない
2. 最後のセクション「仮面を被る、ということ」にタグがない

**修正が必要です。**
```

---

### 4. 修正提案

各H2セクションの内容を読み、適切なH3見出しを提案してください。

**重要な原則:**
- ✅ 既存の文章から自然にH3を抽出する
- ✅ 内容の区切りが明確な部分にH3を追加
- ❌ 無理に新しい内容を追加しない
- ❌ 短い段落を無理やり分割しない

**H3見出しの作り方:**
1. 既存の文章を読む
2. 自然な段落の区切りを見つける
3. その段落が何について書いているか要約する
4. 要約を疑問形 or 体言止めでH3見出しにする

**提案の表示例:**
```
## 修正提案

### Aboutセクション
現在の内容を読むと、以下の2つのトピックに分かれています：
- リリース情報とヒット曲としての成功
- この曲のテーマ「仮面を被る」について

**提案するH3:**
1. ### <span class="section-subtitle">世界的ヒット曲としての成功</span>
2. ### <span class="section-subtitle">「仮面を被る」というテーマ</span>

### Lyricsセクション
現在の内容を読むと、以下の3つのトピックに分かれています：
- 「Poker Face」の意味
- 繰り返しの効果
- 二重の意味を持つ歌詞

**提案するH3:**
1. ### <span class="section-subtitle">タイトル「Poker Face」の意味</span>
2. ### <span class="section-subtitle">繰り返しが生む効果</span>
3. ### <span class="section-subtitle">二重の意味を持つ歌詞</span>

（以下、すべてのH2セクションについて同様に提案）

---

この提案で修正しますか？（y/n）
```

---

### 5. 承認と適用

ユーザーが承認したら、以下を実行：

1. **H3見出しを追加**: 提案したH3見出しを適切な位置に挿入
2. **タグを修正**: タグがないH2/H3にタグを追加
3. **最後のセクションを修正**: 「Thoughts <span class="section-subtitle">」形式に統一

**重要**:
- 既存の文章は変更しない
- H3見出しを追加するだけ
- 段落の順序は変えない

---

### 6. 修正結果の確認

修正後、再度診断を実行して結果を表示：

```
## 修正完了

**修正後:**
- H2セクション: 5個
- H3セクション: 10個 ✅
- タグがないH2: 0個 ✅
- タグがないH3: 0個 ✅

**すべてのH2セクションにH3が追加され、タグも完備されました。**
```

---

### 7. デプロイ

修正が完了したら、以下を実行：

```bash
git add content/posts/[slug].md
git commit -m "記事構造修正: [slug] - H3見出し追加とタグ修正"
git push
```

ユーザーに以下を伝える：
```
修正をデプロイしました。Vercelでのビルド完了後、記事ページで目次を確認してください。
すべてのH2セクションにH3のリンクが表示されるはずです。
```

---

## 注意事項

1. **構造修正のみ**: キーワード追加や新規コンテンツ作成は `/seo-check` で行う
2. **既存文章の尊重**: 文章の内容や順序は変更しない
3. **自然な見出し**: 無理やり分割せず、自然な区切りにH3を追加
4. **一貫性**: 他の記事（Bad Romance, Zoo）の構造を参考にする

---

## 完了後の次のステップ

構造修正が完了したら、ユーザーに以下を提案：

```
構造修正が完了しました！

次のステップ:
1. 記事ページで目次が正しく表示されるか確認
2. 問題がなければ、`/seo-check` でキーワード強化を検討
3. 次の優先度の高い記事の構造修正に進む
```
