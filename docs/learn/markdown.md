# マークダウンで1ページ作る

説明を読むだけではなく、**あなたが1つ、マークダウンで書いたページをこのサイトで表示する**プランです。下のステップを順番にやってみてください。

---

## ゴール

**あなたが作った .md ファイル**が、このサイトの「記事」として **/posts/my-first-page** で表示される状態にすること。

作成したページはトップの記事一覧にも出ます。練習用なので、終わったらファイルを削除したり内容を書き換えたりしてかまいません。

---

## Step 1：ファイルを作る

記事は **content/posts/** フォルダの中の **.md** ファイルです。まず1つ、新しいファイルを作りましょう。

**作るファイルの場所と名前：**

```
content/posts/my-first-page.md
```

Cursor やエディタで「新規ファイル」を作り、上のように **content/posts/my-first-page.md** という名前で保存してください。

---

## Step 2：フロントマターを書く

マークダウンの**いちばん上**に、**---** で囲んだ「メタ情報」を書きます。タイトルと日付があれば、このサイトでは表示できます。

**my-first-page.md の先頭に、次のブロックをそのままコピーして貼り付けてください。** 日付は今日の日付に変えてもOKです。

```yaml
---
title: "はじめてのマークダウンページ"
date: "2026-02-11"
---

（この下に本文を書きます）
```

---

## Step 3：本文をマークダウンで書く

2本目の **---** の下が「本文」です。ここにマークダウンで見出し・段落・リスト・リンクを書くと、サイトでそのままきれいに表示されます。

**次のブロックを、フロントマターの下に貼り付けてください**（「（この下に本文を書きます）」を消して、ここに貼るイメージです）。

```markdown
## このページの見出し

ここは普通の段落です。**太字**も使えます。

### やってみたこと

- マークダウンでファイルを書いた
- 保存してブラウザで開いた
- 表示されて嬉しかった

詳しくは[トップページ](/)へ。
```

貼り付けたマークダウンは、このサイトでは**見出し・太字・箇条書き・リンク**として表示されます。自分で言葉を変えたり、行を足したりしてから保存しても大丈夫です。

---

## Step 4：保存して、ブラウザで開く

**my-first-page.md** を保存したら、開発サーバーを起動して、あなたのページを開きます。

1. ターミナルで `npm run dev` を実行（すでに動いていればそのままでOK）
2. ブラウザで **http://localhost:3000/posts/my-first-page** を開く

ファイル名の **my-first-page** の部分が、URL の **/posts/my-first-page** になります。別の名前のファイル（例：happy.md）なら、**/posts/happy** で開けます。

**ここまでできたら、あなたは「マークダウンで1ページ作って、このサイトに表示する」を体験できたことになります。**

---

## コードを見てわかるようにする（記事表示の裏側）

「.md を書いたのに記事が真っ白」「本文が消える」といった不具合の原因を、コードから追えるようにするための説明です。

### 記事が表示されるまでに、コードで何をしているか

**app/posts/[slug]/page.tsx** では、おおよそ次の順番で処理しています。

1. **getPostBySlug(slug)** … content/posts/〇〇.md を読んで、タイトル・日付・**本文（content）** を取得
2. **extractTourPoster** … 本文から「ツアーポスター用のブロック」を抜き出し、本文からは削除
3. **extractMovieImage** … 本文から「映画画像用のブロック」（🎬 コメント直後の `<a><img></a>`）を抜き出し、本文からは削除
4. **extractYouTubeEmbed** … 同様に YouTube 埋め込み部分を抜き出して本文から削除
5. 残った本文を **マークダウン→HTML 変換**（remark / rehype）して、画面に表示

つまり「本文」は、**いくつかのブロックを「抜き取ったあとの残り」**がマークダウンとして変換されます。抜き取りに使う正規表現が広すぎると、**抜くべきでない本文まで一緒に抜かれて、表示が消える**ことがあります。

### 実例：Issue #26（extractMovieImage のバグ）

映画記事（zootopia-2.md）で「本文がほぼ全部消えて表示されない」という不具合がありました。原因は **extractMovieImage** の正規表現でした。

- 「🎬 のコメント」から「どこか遠くの `</a>`」までを `[\s\S]*?` でマッチさせていた
- 記事の後半にグッズの `<a>...</a>` があったため、**コメント〜その </a> まで**が丸ごと「映画画像」として抜き取られ、本文が消えていた
- 修正：正規表現を「コメントの直後すぐの `<a><img></a>` だけ」に限定（改行をまたがないようにした）

詳しくは **GitHub Issue #26** にまとまっています。同じような「表示が消える」症状が出たときは、**page.tsx の extract〇〇 の正規表現**を疑うと原因にたどりつきやすくなります。

**まとめ：** 教材で「.md を書く → 表示される」を体験したあと、不具合が出たら「**どの関数が本文のどこを抜いているか**」を **app/posts/[slug]/page.tsx** で追うと、こういうエラーの原因がコードを見てわかるようになります。

---

## 文法メモ（書き方の早見）

本文を書くときに「どう書くとどうなるか」のメモです。必要になったら見返してください。

| 書き方 | マークダウン | 説明 |
|--------|--------------|------|
| 見出し | `## 見出し` | # 1個で大、## で中、### で小 |
| 太字 | `**太字**` | ** で囲む |
| リスト | `- 項目` | - とスペース |
| リンク | `[表示文字](URL)` | [ と ]( で囲む |

---

[トップに戻る](/)
